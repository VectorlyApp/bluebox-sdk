{
  "id": "Routine_2c79b8f6-7d18-4854-a1b2-859bb184a344",
  "created_at": 1761882993,
  "updated_at": 1761882993,
  "name": "spirit_one_way_search",
  "description": "Navigate to Spirit.com, obtain a bearer token, then call the availability v3 search API for one-way options and prices. The token is saved and injected into the Authorization header for the search call, mirroring observed traffic.",
  "operations": [
    {
      "type": "navigate",
      "url": "https://www.spirit.com/"
    },
    {
      "type": "sleep",
      "timeout_seconds": 2.5
    },
    {
      "type": "fetch",
      "endpoint": {
        "url": "https://www.spirit.com/api/prod-token/api/v1/token",
        "description": "Issue a JWT used for Authorization: Bearer; response contains data.token.",
        "method": "POST",
        "headers": {
          "sec-ch-ua-platform": "\"macOS\"",
          "Cache-Control": "no-cache",
          "Referer": "https://www.spirit.com/",
          "Pragma": "no-cache",
          "Ocp-Apim-Subscription-Key": "3b6a6994753b4efc86376552e52b8432",
          "Accept": "application/json, text/plain, */*",
          "Content-Type": "application/json",
          "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36"
        },
        "body": {
          "applicationName": "dotRezWeb"
        },
        "credentials": "same-origin"
      },
      "session_storage_key": "token_response"
    },
    {
      "type": "fetch",
      "endpoint": {
        "url": "https://www.spirit.com/api/prod-availability/api/availability/v3/search",
        "description": "One-way availability and prices for a single date (beginDate=endDate).",
        "method": "POST",
        "headers": {
          "sec-ch-ua-platform": "\"macOS\"",
          "Authorization": "Bearer \"{{sessionStorage:token_response.data.token}}\"",
          "Cache-Control": "no-cache",
          "Referer": "https://www.spirit.com/",
          "Accept-Language": "en-US",
          "Pragma": "no-cache",
          "Ocp-Apim-Subscription-Key": "3b6a6994753b4efc86376552e52b8432",
          "Accept": "application/json, text/plain, */*",
          "Content-Type": "application/json",
          "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36"
        },
        "body": {
          "includeWifiAvailability": true,
          "criteria": [
            {
              "stations": {
                "originStationCodes": [
                  "\"{{origin}}\""
                ],
                "destinationStationCodes": [
                  "\"{{destination}}\""
                ],
                "searchDestinationMacs": false
              },
              "dates": {
                "beginDate": "\"{{date}}\"",
                "endDate": "\"{{date}}\""
              },
              "filters": {
                "filter": "Default"
              }
            }
          ],
          "passengers": {
            "types": [
              {
                "type": "ADT",
                "count": "{{adt_count}}"
              }
            ]
          },
          "codes": {
            "currency": "USD"
          },
          "fareFilters": {
            "loyalty": "MonetaryOnly",
            "types": [],
            "classControl": 1
          },
          "taxesAndFees": "TaxesAndFees",
          "originalJourneyKeys": [],
          "originalBookingRecordLocator": null,
          "infantCount": 0,
          "birthDates": [],
          "includeBundleAvailability": true
        },
        "credentials": "same-origin"
      },
      "session_storage_key": "availability_search_response"
    },
    {
      "type": "return",
      "session_storage_key": "availability_search_response"
    }
  ],
  "incognito": true,
  "parameters": [
    {
      "name": "origin",
      "type": "string",
      "required": true,
      "description": "Origin IATA station code for the one-way search.",
      "default": "BOS",
      "examples": [
        "BOS",
        "LAX",
        "DTW"
      ],
      "min_length": 3,
      "max_length": 3,
      "min_value": null,
      "max_value": null,
      "pattern": "^[A-Z]{3}$",
      "enum_values": null,
      "format": null
    },
    {
      "name": "destination",
      "type": "string",
      "required": true,
      "description": "Destination IATA station code for the one-way search.",
      "default": "MIA",
      "examples": [
        "MIA",
        "FLL",
        "LAS"
      ],
      "min_length": 3,
      "max_length": 3,
      "min_value": null,
      "max_value": null,
      "pattern": "^[A-Z]{3}$",
      "enum_values": null,
      "format": null
    },
    {
      "name": "date",
      "type": "date",
      "required": true,
      "description": "Departure date. For one-way single-day search, beginDate=endDate=date.",
      "default": "2025-10-31",
      "examples": [
        "2025-10-31",
        "2025-11-15"
      ],
      "min_length": null,
      "max_length": null,
      "min_value": null,
      "max_value": null,
      "pattern": null,
      "enum_values": null,
      "format": "YYYY-MM-DD"
    },
    {
      "name": "adt_count",
      "type": "integer",
      "required": true,
      "description": "Number of adult (ADT) passengers.",
      "default": 1,
      "examples": [
        1,
        2
      ],
      "min_length": null,
      "max_length": null,
      "min_value": 1,
      "max_value": null,
      "pattern": null,
      "enum_values": null,
      "format": null
    }
  ]
}